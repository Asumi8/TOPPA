<div class="container">
  <div class="row justify-content-center">
    <div class="col-12">
      <div class = "card">
        <div class="card-body">
        <h1>Tasks List</h1>
        <p class="col-lg-12 title">- „Çø„Çπ„ÇØ‰∏ÄË¶ß -</p>

        <button class="btn btn-secondary col-6">
          <%= link_to '„Çø„Çπ„ÇØ„Çí„Å§„Åè„Çã',  new_team_task_path(params[:team_id]) %>
        </button>
        <p>
          <span>„ÉÅ„Éº„É†„ÅÆMVP</span>
          <%= button_to 'mvp„ÇíÊ±∫„ÇÅ„ÇãÔºÅ', mvp_team_path(params[:team_id]), method: :get %>
        </p>

                <%= link_to "Áä∂Ê≥Å‚ñº", team_tasks_path(sort_status: "true")%>
                <%= link_to "ÊúüÈôê‚ñº", team_tasks_path(sort_expired: "true") %>
                <%= link_to "‰ΩúÊàêÊó•‚ñº", team_tasks_path(sort_created: "true")%>

          <% @tasks.each do |task| %>
            <div class="col-lg-12">
              <div class="card task">
                <h6 class="card-title">
                  <div class="left-box">
                    <span class="column category">„Ç´„ÉÜ„Ç¥„É™</span><%= task.category.name %>
                    <% if (task.expired_at - @date).to_i < 7 && task.status == false %>
                      <span class="column expire">ÊúüÈôê</span>
                      <span class="urgent"><%= task.expired_at %></span>
                    <% else %>
                      <span class="column expire">ÊúüÈôê</span>
                      <%= task.expired_at %>
                      <% end %>
                    <% task.created_at.strftime('%Y-%m-%d') %>
                    <% count = (task.expired_at - task.created_at.to_date).to_i %>
                    <% today = (task.expired_at - @date.tomorrow).to_i %>
                    <% if count > 0 || today > 0 %>
                      <% @expired_at_count = today*100/count %>
                    <% else %>
                      <% @expired_at_count = 0 %>
                    <% end %>
                    <label for="file">
                    <progress id="file" max="100" value=<%= @expired_at_count %>></progress></label>
                  </div>
                  <div class="right-box">
                    <span class="column create">‰ΩúÊàêÊó•:<%= task.created_at.strftime('%Y-%m-%d') %></span>
                  </div>
                </h6>
                <div class="card-body task">
                  <% if task.status == true  %>
                    <label>‚úÖ</label>
                  <% else %>
                    <label>üü©</label>
                  <% end %>

                  <span class="column name">„Çø„Çπ„ÇØ</span><%= task.name %>
                  <% if task.repeat == true %>
                    <label>üîÑ</label>
                  <% else %>
                    <label></label>
                  <% end %>

                  <%= link_to 'Ë©≥Á¥∞', task %>
                  <%= link_to 'Á∑®ÈõÜ', edit_task_path(id:task.id, team_id:task.team_id) %>
                  <%= link_to 'ÂâäÈô§', task, method: :delete, data: { confirm: 'Are you sure?' } %>
                </div>
              </div>
            </div>
          <% end %>
          <%= paginate @tasks %>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
.urgent{
  color: #F85B57;
  font-weight:bold;
}
label {
    padding-right: 10px;
    font-size: 1rem;
}
progress {
  -webkit-appearance: none;
}
::-webkit-progress-bar {
  background-color: #dadce0 ;
}
::-webkit-progress-value {
  background-color: #F85B57 ;
  }
.card{
  background-color:#ECDDD6;
  border: #fff;
  padding: 10px;
}
.title{
  text-align:center;
  font-size:18px;
  color:#524f4f;
}
.card.task{
  background-color: #fff;
  margin: 10px;
  color:#50595B;
}
.card-body{
  padding:1.25rem;
  color:#50595B;
}
.colmun{
  font-weight:bold;
}

.column.category{
  background-color:#5f6466;
  color:white;
  padding:2px;
  font-size:14px;
  margin-right:5px;
}
.column.name{
  background-color:#F3A5A3;
  color:white;
  padding:2px;
  font-size:14px;
  margin:0 5px;
}
.column.create{
  color:grey;
  padding:2px;
  font-size:14px;
  margin:0 5px;
}
.column.expire{
  background-color:#F85B57;
  color:white;
  padding:2px;
  font-size:14px;
  margin-right:5px;
}
h6{
  display:flex;
  position:relative;
}

.right-box{
  position:absolute;
  right:0;
}
.btn-secondary a{
  color:white;
}
</style>